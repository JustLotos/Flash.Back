<template>
    <v-container>
        <v-card v-if="user">
            <v-layout justify-center>
                <v-flex>
                    <v-row>
                        <v-col cols="4">
                            <v-card-actions class="justify-center pa-2">
                                <v-avatar class="profile" color="grey" size="164" tile>
                                    <v-img src="https://cdn.vuetifyjs.com/images/profiles/marcus.jpg"></v-img>
                                </v-avatar>
                            </v-card-actions>
                        </v-col>
                        <v-col cols="8" style="width: 400px">
                            <v-flex>
                                <v-row class="no-gutters">
                                    <v-col cols="24">
                                        <v-card-text class="pa-2" >{{ role }} - {{ status }}</v-card-text >
                                    </v-col>
                                </v-row>
                                <v-row class="no-gutters">
                                    <v-col cols="24">
                                        <v-card-text class="pa-2" >Имя</v-card-text >
                                    </v-col>
                                    <v-col cols="24">
                                        <v-card-text class="pa-2">{{user.name.firstName || 'Не указано'}}</v-card-text>
                                    </v-col>
                                </v-row>
                                <v-row class="no-gutters">
                                    <v-col cols="24">
                                        <v-card-text class="pa-2" >Фамилия</v-card-text >
                                    </v-col>
                                    <v-col cols="24">
                                        <v-card-text class="pa-2">{{user.name.lastName || 'Не указано'}}</v-card-text>
                                    </v-col>
                                </v-row>
                                <v-row class="no-gutters">
                                    <v-col cols="24" lg12>
                                        <v-card-text class="pa-2">Электронная почта</v-card-text>
                                    </v-col>
                                    <v-col cols="24" lg12>
                                        <v-card-text class="pa-2">{{user.email}}</v-card-text>
                                    </v-col>
                                </v-row>
                            </v-flex>
                        </v-col>
                    </v-row>
                </v-flex>
            </v-layout>
        </v-card>
    </v-container>
</template>

<script lang="ts">
import { Component, Vue } from "vue-property-decorator";
import {ILearnerResponse, LearnerModule} from "../Store/LearnerModule";
import {AuthModule} from "../../Common/Store/AuthModule";
Component.registerHooks(['beforeRouteEnter']);

@Component
export default class ProfilePage extends Vue{
    beforeRouteEnter (to, from, next) {
        LearnerModule.getProfile()
            .then(()=>{next()})
            .catch((error)=>{ console.log('Произошла ошибка извлечения пользователя' + JSON.parse(error.response)); next(); });
    }

    get role(): string {
        return AuthModule.getRole;
    }

    get status(): string {
        return AuthModule.getStatus;
    }

    get user(): ILearnerResponse {
        return LearnerModule.user;
    }
}
</script>